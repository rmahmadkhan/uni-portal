# Render Blueprint (optional) â€” creates a web service + managed Postgres.
# Docs: https://render.com/docs/blueprint-spec
#
# Note:
# - Render Postgres instances must be defined under the top-level `databases:` field.
# - Docker-based services should use `runtime: docker` (the older `env: docker` still exists but is discouraged).

databases:
  - name: university-portal-db
    # Pick a plan supported by your Render account.
    # (Render's free tier availability changes over time.)
    plan: starter
    postgresMajorVersion: "16"
    databaseName: portal_db
    user: portal_user
    diskSizeGB: 1

services:
  - type: web
    name: university-portal
    runtime: docker
    plan: starter
    healthCheckPath: /healthz/
    envVars:
      - key: DJANGO_SETTINGS_MODULE
        value: university_portal.settings_prod
      - key: DJANGO_SECRET_KEY
        generateValue: true

      # These must match your real service URL / custom domain.
      # Using `sync: false` prompts for values during initial Blueprint creation.
      - key: DJANGO_ALLOWED_HOSTS
        sync: false
      - key: DJANGO_SITE_URL
        sync: false
      - key: DJANGO_CSRF_TRUSTED_ORIGINS
        sync: false

      - key: DATABASE_URL
        fromDatabase:
          name: university-portal-db
          property: connectionString
